<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script src="../node_modules/html2canvas/dist/html2canvas.min.js"></script>
  </head>
  <body>
    <form action="" id="form">
      <input type="text" name="username" /><br />
      <input type="text" name="age" /><br />
    </form>
    <button id="saveImage">保存图片</button>
    <script>
      window.onload = function() {
        setTimeout(function() {
          html2canvas(document.querySelector("#form")).then(function(canvas) {
            setTimeout(function() {
              Canvas2Image.saveAsPNG(canvas);
            }, 2000);
            // document.body.appendChild(canvas);
            // canvastoImg(document.getElementsByTagName("canvas")[0],'finalImg')
          }, 10000);
          // 保存文件函数
          var saveFile = function(data, filename) {
            var save_link = document.createElementNS(
              "http://www.w3.org/1999/xhtml",
              "a"
            );
            save_link.href = data;
            save_link.download = filename;
            var event = document.createEvent("MouseEvents");
            event.initMouseEvent(
              "click",
              true,
              false,
              window,
              0,
              0,
              0,
              0,
              0,
              false,
              false,
              false,
              false,
              0,
              null
            );
            save_link.dispatchEvent(event);
          };
          document
            .querySelector("#saveImage")
            .addEventListener("click", function() {
              function convertCanvasToImage(canvas) {
                var image = new Image();
                image.src = canvas.toDataURL("image/png");
                return image;
              }

              saveFile();
              convertCanvasToImage(document.querySelector("canvas"));
            });
        }, 1000);
      };
    </script>
  </body>
</html>
